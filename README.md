# **Stock Movement Prediction Model Using Reddit Data**

## Overview
This project aims to predict stock movement based on sentiment and engagement data from Reddit's "stocks" subreddit. The pipeline includes scraping Reddit posts, preprocessing data, performing sentiment analysis, and training a machine learning model using XGBoost.

The final model achieved:
- **Mean Absolute Error (MAE)**: 29.65
- **Root Mean Squared Error (RMSE)**: 39.94
- **R² Score**: 97.17%

## Features

### **Data Scraping**
- Utilized the **PRAW** library to collect data (titles, scores, comments, timestamps) from the "stocks" subreddit.

### **Preprocessing**
- Extracted temporal features like **day of the week**, **time of day**, and **weekend indicator**.
- Calculated **sentiment scores** using the **VADER Sentiment Analysis** tool.
- Created additional features, such as:
  - **Comment-to-score ratio**
  - **Weighted sentiment** (based on positive and negative sentiment adjusted by post score)
- Cleaned and transformed data for model training.

### **Sentiment Analysis**
- **VADER SentimentIntensityAnalyzer** is used to analyze the sentiment of Reddit post titles.
  - Calculated **sentiment_score** (compound score), **positive_sentiment**, **negative_sentiment**, and **neutral_sentiment**.
  - A **weighted_sentiment** score was created by subtracting negative sentiment from positive sentiment and multiplying by the post's score to account for post popularity.
  - A **composite sentiment score** was generated by combining **sentiment_score** and **weighted_sentiment**, which provides a more comprehensive measure of sentiment.

### **Feature Engineering**
- Additional features like **comment-to-score ratio** and **weighted sentiment** were computed to capture engagement-related signals from Reddit posts.
  
### **Exploratory Data Analysis (EDA)**
- **Univariate Analysis**: The distribution of each feature was examined to identify outliers and trends.
- **Bivariate Analysis**: The relationships between different pairs of features were explored to understand correlations and dependencies.
  - **Correlation Matrix**: Analyzed correlations between features such as **score**, **num_comments**, **sentiment_score**, etc.
  - **Scatter Plots**: Used to visualize relationships, such as between **score** and **sentiment_score**, or **num_comments** and **stock_movement**.

### **Modeling and Evaluation**
- **Model Training**: Used **XGBoost** for regression, which was optimized through **GridSearchCV** for hyperparameter tuning.
- **Evaluation**: Assessed the model using the following metrics:
  - **Mean Absolute Error (MAE)**: 29.65
  - **Root Mean Squared Error (RMSE)**: 39.94
  - **R² Score**: 97.17%
- The model showed excellent predictive performance, with minimal signs of overfitting.

## Setup Instructions

### **Prerequisites**
- Python (>=3.7)

### **Required libraries**
- praw  
- pandas  
- numpy  
- scikit-learn  
- xgboost  
- vaderSentiment  
- matplotlib  
- seaborn

Install dependencies using:

```bash
pip install praw pandas numpy scikit-learn xgboost vaderSentiment matplotlib seaborn
```

### **Reddit API Configuration**
- Register for API credentials on the [Reddit Developer Portal](https://www.reddit.com/dev/api/).
- Add your **client_id**, **client_secret**, and **user_agent** to the script:
  ```python
  reddit = praw.Reddit(
      client_id="YOUR_CLIENT_ID",
      client_secret="YOUR_CLIENT_SECRET",
      user_agent="YOUR_USER_AGENT"
  )
  ```

### **Run the Script**
- Ensure all dependencies are installed and API credentials are configured.
- Execute the Jupyter Notebook or Python script:
  ```bash
  jupyter notebook stock_movement_prediction.ipynb
  ```
  or
  ```bash
  python stock_movement_prediction.py
  ```

## Pipeline Overview

### **Data Scraping**
- Scraped 1,000 posts from Reddit, extracting features like title, score, num_comments, and timestamp.

### **Feature Engineering**
- Temporal: Extracted **day_of_week**, **is_weekend**, and **time_of_day**.
- Sentiment: Used VADER to compute **sentiment_score** (compound), **positive_sentiment**, **negative_sentiment**, and **neutral_sentiment**.
- Ratios: Computed **comment_to_score_ratio** and **weighted_sentiment**.

### **Modeling and Evaluation**
- Split data into training (80%) and test (20%) sets.
- Standardized features using **StandardScaler**.
- Trained an **XGBoost regression model** with hyperparameter tuning (learning rate, max depth, estimators, etc.).

## Results
| Metric | Value |
|--------|-------|
| **MAE** | 29.65 |
| **RMSE** | 39.94 |
| **R² Score** | 97.17% |

The model demonstrates excellent predictive performance, leveraging sentiment analysis and engagement data from Reddit discussions to predict stock movement with high accuracy.

## Files
- **stock_movement_prediction.ipynb**: Jupyter Notebook containing the full pipeline.
- **README.md**: This documentation.
- **requirements.txt**: List of all dependencies.

## Future Work
- **Enhance Sentiment Analysis**: Experiment with advanced NLP models like **BERT** for more refined sentiment detection.
- **Integrate Financial Data**: Combine Reddit data with **stock price trends** to improve prediction robustness.
- **Optimize Model**: Explore other algorithms like **LightGBM** and **CatBoost** for further improvements in predictive accuracy.

## Author
**Nasreen Fatima**  
2024


